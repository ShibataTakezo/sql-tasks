#59
UPDATE 口座
SET 残高 = 残高 + (SELECT SUM(入金額) - SUM(出金額) AS 入出金額
            FROM 取引
            WHERE 口座番号 = '0351333' AND 日付 = '2024-01-11'),
    更新日 = CURRENT_DATE
WHERE 口座番号 = '0351333';

#60
SELECT 残高, 
      (SELECT SUM(入金額) AS 入金額
      FROM 取引
      WHERE 口座番号 = '1115600' AND 日付 = '2023-12-28'),
      (SELECT SUM(出金額) AS 出金学
      FROM 取引
      WHERE 口座番号 = '1115600' AND 日付 = '2023-12-28')
FROM 口座
WHERE 口座番号 = '1115600';

#61
SELECT 口座番号, 名義, 残高
FROM 口座
WHERE 口座番号 IN (SELECT 口座番号
                   FROM 取引
                   WHERE 入金額 >= 1000000);

#62
SELECT *
FROM 口座
WHERE 更新日 > ALL (SELECT 日付 FROM 取引);

#63
SELECT DISTINCT 日付,
(SELECT MAX(入金額)
FROM 取引
WHERE 口座番号 = '3104451'),
(SELECT MAX(出金額)
FROM 取引
WHERE 口座番号 = '3104451')
FROM (SELECT *
FROM 取引
WHERE 口座番号 = '3104451'
  AND 出金額 IS NOT NULL
  AND 日付 IN (
    SELECT 日付
    FROM 取引
    WHERE 口座番号 = '3104451'
      AND 入金額 IS NOT NULL
))

#64
INSERT INTO 廃止口座
SELECT 口座番号, 名義, 種別, 残高, CURRENT_DATE
FROM 口座
WHERE 口座番号 = '2761055';

DELETE FROM 口座
WHERE 口座番号 = '2761055';
